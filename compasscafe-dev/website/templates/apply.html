{% extends "template.html" %}{% block title %}Apply{% endblock %}
{% block content %}

<section class="beigespace-test">
    <br>
    <br>
    <br>
    <br>
  <div class="preload-fadein">
    <h1>Applications</h1>
    <br>

        <div class="row">
        <div class="col col-md-4">
            <div id="posts">
                {% if not user.is_staff %}
                <h3>Your Applications</h3>
                {% else %}
                <h3>All Applications</h3>
                {% endif %}

                {% for post in post_pending %}
                {% if user.id == post.author or user.is_staff %}
                <div class="card card-apply">
                    <div class="card-body">
                        <a href="/posts/{{ post.user.username }}">{{ post.user.username }}</a>
                        {% if user.id == post.author or user.is_staff %}
                        <div class="btn-group" id="apply-delete">
                            <button type="button" class="btn btn-primary dropdown-toggle btn-lg" data-bs-toggle="dropdown"></button>
                            <ul class="dropdown-menu">
                                <li><a href="/apply/delete-apply/{{ post.id }}" class="dropdown-item">Delete</a></li>
                                {% if user.is_staff %}
                                <li><a href="/apply/accept-apply/{{ post.id }}" class="dropdown-item">Accept</a></li>
                                {% endif %}
                            </ul>
                        </div>
                        {% endif %}
                        <div class="card-text">
                            <p>{{ post.schoolid }}</p>
                            <p><strong>{{ post.firstname }} {{ post.lastname }}</strong></p>
                            <p><strong>{{ post.date_day }}, {{ post.date_duty }}</strong></p>
                            <p><strong>Year Level:</strong> {{ post.yearlevel }}</p>
                        </div>
                    </div>
                </div>
                <br/>
                {% endif %}
                {% endfor %}
            </div>
            {% if not user.is_staff %}
            <br/>
            <div align="center">
                <a href="/apply/submit_duty"><button type="button" class="btn btn-primary btn-lg">Submit an Application</button></a>
            </div>
            <br/>
            {% endif %}
        </div>
        <div class="col col-md-8">
            <div class="dashboarduser-table">
                <h3>Barista Roster</h3>
                <h6>Week A</h6>
                <p>Lunch : 11:00 AM - 11:25 AM</p>
                <table class="table">
                    <thead>
                        <tr>
                            <th>MON</th>
                            <th>TUE</th>
                            <th>WED</th>
                            <th>THU</th>
                            <th>FRI</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Store Varied Applications : WEEK A -->
                        {% set week_a = {'tuesday': [], 'thursday': []} %}
                        {% for post in post_accept %}
                            {% if post.date_duty == 'Week A' %}
                                {% set day = post.date_day.lower() %}
                                {% if day in week_a %}
                                    {% set _ = week_a[day].append(post) %}
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                
                        <!-- Check Number of Applications -->
                        <!-- Set Max to the Most Entries for either Tuesday or Thursday -->
                        {% set max_entries = week_a.tuesday|length if week_a.tuesday|length > week_a.thursday|length else week_a.thursday|length %}
                
                        <!-- Update Rows on Number of Applications -->
                        {% for applylvl in range(max_entries) %}
                        <tr>
                            <td> </td>
                            <td>
                                {% if applylvl < week_a.tuesday|length %}
                                    <p>{{ week_a.tuesday[applylvl].firstname }} {{ week_a.tuesday[applylvl].lastname }}</p>
                                {% endif %}
                            </td>
                            <td> </td>
                            <td>
                                {% if applylvl < week_a.thursday|length %}
                                    <p>{{ week_a.thursday[applylvl].firstname }} {{ week_a.thursday[applylvl].lastname }}</p>
                                {% endif %}
                            </td>
                            <td> </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                
            </div>            
            <br>
            <div class="dashboarduser-table">
                <h3>Barista Roster</h3>
                <h6>Week B</h6>
                <p>Lunch : 11:00 AM - 11:25 AM</p>
                <table class="table">
                    <thead>
                        <tr>
                            <th>MON</th>
                            <th>TUE</th>
                            <th>WED</th>
                            <th>THU</th>
                            <th>FRI</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Store Varied Applications : WEEK B -->
                        {% set week_b = {'tuesday': [], 'thursday': []} %}
                        {% for post in post_accept %}
                            {% if post.date_duty == 'Week B' %}
                                {% set day = post.date_day.lower() %}
                                {% if day in week_b %}
                                    {% set _ = week_b[day].append(post) %}
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                
                        <!-- Check Number of Applications -->
                        <!-- Set Max to the Most Entries for either Tuesday or Thursday -->
                        {% set max_entries = week_b.tuesday|length if week_b.tuesday|length > week_b.thursday|length else week_b.thursday|length %}
                
                        <!-- Update Rows on Number of Applications -->
                        {% for applylvl in range(max_entries) %}
                        <tr>
                            <td> </td>
                            <td>
                                {% if applylvl < week_b.tuesday|length %}
                                    <p>{{ week_b.tuesday[applylvl].firstname }} {{ week_b.tuesday[applylvl].lastname }}</p>
                                {% endif %}
                            </td>
                            <td> </td>
                            <td>
                                {% if applylvl < week_b.thursday|length %}
                                    <p>{{ week_b.thursday[applylvl].firstname }} {{ week_b.thursday[applylvl].lastname }}</p>
                                {% endif %}
                            </td>
                            <td> </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        
    </div>
  </div>
</section>

  

{% endblock %}
